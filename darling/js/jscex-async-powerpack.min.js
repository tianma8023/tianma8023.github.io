!function(){var e=function(e){if(e.length<=1)return null;for(var t=[],n=1;n<e.length;n++)t.push(e[n]);return t},t=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]);for(;n.length<t;)n.push(void 0);return n},n=function(n){if(!n.modules["async-powerpack"]){if(!n.modules.async)throw Error('Missing essential components, please initialize "jscex-async" module first.');var r=n.Async,i=r.Task,s=r.CanceledError;r.sleep=function(e,t){return i.create(function(n){t&&t.isCancellationRequested&&n.complete("failure",new s);var r,i;t&&(i=function(){clearTimeout(r),n.complete("failure",new s)}),r=setTimeout(function(){t&&t.unregister(i),n.complete("success")},e),t&&t.register(i)})},r.onEvent=function(e,t,n){return i.create(function(r){n&&n.isCancellationRequested&&r.complete("failure",new s);var i,o,c=function(){e.removeEventListener?e.removeEventListener(t,i):e.removeListener?e.removeListener(t,i):e.detachEvent(t,i)};n&&(o=function(){c(),r.complete("failure",new s)}),i=function(e){n&&n.unregister(o),c(),r.complete("success",e)},e.addEventListener?e.addEventListener(t,i):e.addListener?e.addListener(t,i):e.attachEvent(t,i),n&&n.register(o)})},i.whenAll=function(){var e,t={};if(1==arguments.length){var n=arguments[0];i.isTask(n)?(t[0]=n,e=!0):(t=n,e="[object Array]"===Object.prototype.toString.call(t))}else{for(n=0;n<arguments.length;n++)t[n]=arguments[n];e=!0}return i.create(function(n){var r,s={};for(r in t)if(t.hasOwnProperty(r)){var o=t[r];i.isTask(o)&&(s[o.id]=r)}for(var c in s)o=t[s[c]],"ready"==o.status&&o.start();for(c in s)if(o=t[s[c]],o.error)return void n.complete("failure",o.error);var a=e?[]:{},u=function(e){if(e.error){for(var r in s)t[s[r]].removeEventListener("complete",u);n.complete("failure",e.error)}else a[s[e.id]]=e.result,delete s[e.id],0==--f&&n.complete("success",a)},f=0;for(c in s)r=s[c],o=t[r],"succeeded"==o.status?(a[r]=o.result,delete s[o.id]):(f++,o.addEventListener("complete",u));0==f&&n.complete("success",a)})},i.whenAny=function(){var e={};if(1==arguments.length){var t=arguments[0];i.isTask(t)?e[0]=t:e=t}else for(t=0;t<arguments.length;t++)e[t]=arguments[t];return i.create(function(t){var n,r={};for(n in e)if(e.hasOwnProperty(n)){var s=e[n];i.isTask(s)&&(r[s.id]=n)}for(var o in r)s=e[r[o]],"ready"==s.status&&s.start();for(o in r)if(n=r[o],s=e[n],s.error||"succeeded"==s.status)return void t.complete("success",{key:n,task:s});var c=function(n){for(var i in r)e[r[i]].removeEventListener("complete",c);t.complete("success",{key:r[n.id],task:n})};for(o in r)e[r[o]].addEventListener("complete",c)})},r.Jscexify||(r.Jscexify={}),r=r.Jscexify,r.fromStandard=function(n){var r=e(arguments);return function(){var e=this,s=t(arguments,n.length-1);return i.create(function(t){s.push(function(e,n){if(e)t.complete("failure",e);else{if(r){for(var i={},s=0;s<r.length;s++)i[r[s]]=arguments[s+1];return t.complete("success",i)}t.complete("success",n)}}),n.apply(e,s)})}},r.fromCallback=function(n){var r=e(arguments);return function(){var e=this,s=t(arguments,n.length-1);return i.create(function(t){s.push(function(e){if(r){for(var n={},i=0;i<r.length;i++)n[r[i]]=arguments[i];t.complete("success",n)}else t.complete("success",e)}),n.apply(e,s)})}},n.modules["async-powerpack"]=!0}},r="function"==typeof define&&!define.amd,i="function"==typeof require&&"function"==typeof define&&define.amd;if("function"==typeof require&&"undefined"!=typeof module&&module.exports)module.exports.init=n;else if(r)define("jscex-async-powerpack",["jscex-async"],function(e,t,r){r.exports.init=n});else if(i)define("jscex-async-powerpack",["jscex-async"],function(){return{init:n}});else{if("undefined"==typeof Jscex)throw Error('Missing the root object, please load "jscex" module first.');n(Jscex)}}();